# P6 Summary Schedule Generator

## ðŸ“ Folder Structure

```
summary_schedule_generator/
â”œâ”€â”€ README.md                    # This file - Overview and quick start guide
â”œâ”€â”€ docs/                        # Documentation
â”‚   â””â”€â”€ README_generate_summary_schedule.md  # Detailed technical documentation
â”œâ”€â”€ scripts/                     # Python scripts
â”‚   â””â”€â”€ generate_summary_schedule.py         # Main generator script
â”œâ”€â”€ templates/                   # Template XER files
â”‚   â””â”€â”€ 19282-FS-Summary-FS-EXE.xer         # P6 project template
â”œâ”€â”€ input/                       # Input data files
â”‚   â””â”€â”€ WBS Summary.xlsx         # Excel file with summary WBS data
â””â”€â”€ output/                      # Generated output files
    â””â”€â”€ 19282_Summary_Schedule_Generated.xer  # Generated summary schedule

```

## ðŸŽ¯ Purpose

This toolset automates the generation of Primavera P6 Summary Schedules from Excel-based WBS summary data. It eliminates manual data entry and ensures consistency in schedule formatting.

## ðŸš€ Quick Start

### Prerequisites

```bash
# Install required Python packages
pip install pandas openpyxl
```

### Running the Script

```bash
# Navigate to the scripts folder
cd "C:/Users/ckr_4/01 Projects/P6PlanningIntegration/summary_schedule_generator/scripts"

# Run the generator
python generate_summary_schedule.py
```

### Expected Output

```
2026-01-20 11:18:28 | INFO     | ================================================================================
2026-01-20 11:18:28 | INFO     | P6 Summary Schedule Generator
2026-01-20 11:18:28 | INFO     | ================================================================================
2026-01-20 11:18:28 | INFO     | Loading summary data from: ../input/WBS Summary.xlsx
2026-01-20 11:18:28 | INFO     | Loaded 66 rows from Excel
2026-01-20 11:18:28 | INFO     | Filtered out 12 rows with zero/empty activities
2026-01-20 11:18:28 | INFO     | Remaining rows: 54
2026-01-20 11:18:28 | INFO     | Parsing template XER: ../templates/19282-FS-Summary-FS-EXE.xer
2026-01-20 11:18:28 | INFO     | Generated 54 tasks from summary data
2026-01-20 11:18:28 | INFO     | âœ“ Successfully generated summary schedule
```

The output file will be created at: `output/19282_Summary_Schedule_Generated.xer`

## ðŸ“‚ Folder Descriptions

### `/docs` - Documentation
Contains detailed technical documentation, usage guides, and API references.

**Files:**
- `README_generate_summary_schedule.md` - Comprehensive technical documentation including:
  - Detailed usage instructions
  - Field mapping reference
  - Troubleshooting guide
  - Customization examples
  - XER format technical details

### `/scripts` - Python Scripts
Contains the executable Python scripts for schedule generation.

**Files:**
- `generate_summary_schedule.py` - Main script that:
  - Loads Excel data from `input/`
  - Parses template XER from `templates/`
  - Generates summary schedule
  - Writes output to `output/`

### `/templates` - Template XER Files
Contains P6 XER files used as templates for schedule generation. These provide the project structure, calendars, and metadata.

**Files:**
- `19282-FS-Summary-FS-EXE.xer` - Template containing:
  - Project metadata (PROJECT table)
  - WBS structure (PROJWBS table)
  - Calendar definitions (CALENDAR table)
  - Currency settings (CURRTYPE table)
  - Other P6 configuration tables

**Purpose:** Ensures generated schedules have consistent P6 settings and proper project structure.

### `/input` - Input Data Files
Contains Excel files with WBS summary data that drives schedule generation.

**Files:**
- `WBS Summary.xlsx` - Excel file with required columns:
  - `WBS Code` - Activity ID
  - `WBS Name` - Activity description
  - `Total Activities` - Activity count (filters out if 0/empty)
  - `Start` - Start date
  - `Finish` - Finish date

**Data Quality:**
- Rows with `Total Activities = 0` are automatically filtered
- Invalid dates generate warnings but don't stop processing
- Excel supports standard date formats

### `/output` - Generated Output Files
Contains XER files generated by the script. This folder is the destination for all produced schedules.

**Files:**
- `19282_Summary_Schedule_Generated.xer` - Generated P6 schedule in XER format
  - Can be imported directly into Primavera P6
  - Contains tasks from Excel mapped to P6 structure
  - Preserves all template metadata and settings

## ðŸ”„ Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WBS Summary    â”‚         â”‚  Template XER    â”‚
â”‚  (Excel)        â”‚         â”‚  (P6 Structure)  â”‚
â”‚                 â”‚         â”‚                  â”‚
â”‚  input/         â”‚         â”‚  templates/      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â”‚                           â”‚
         â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  generate_summary_schedule.py      â”‚
    â”‚                                    â”‚
    â”‚  1. Load & filter Excel data       â”‚
    â”‚  2. Parse template XER             â”‚
    â”‚  3. Extract project metadata       â”‚
    â”‚  4. Generate TASK records          â”‚
    â”‚  5. Write output XER               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Generated XER   â”‚
            â”‚  (P6 Schedule)   â”‚
            â”‚                  â”‚
            â”‚  output/         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Import to P6    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“‹ Input File Requirements

### Excel File (`input/WBS Summary.xlsx`)

| Column | Type | Required | Description | Example |
|--------|------|----------|-------------|---------|
| WBS Code | Text | Yes | Unique activity identifier | 19282-FS-CURRENT-35.6.11 |
| WBS Name | Text | Yes | Activity description | Key Milestones |
| Total Activities | Number | Yes | Activity count (0 = filtered out) | 5 |
| Start | Date | Yes | Planned start date | 2026-01-19 |
| Finish | Date | Yes | Planned finish date | 2027-08-17 |

### Template File (`templates/19282-FS-Summary-FS-EXE.xer`)

Must contain valid P6 XER format with:
- ERMHDR header
- PROJECT table (at least 1 project)
- PROJWBS table (with root WBS)
- CALENDAR table
- Other standard P6 metadata tables

## ðŸ”§ Configuration

### Changing Input/Output Paths

To use different files, you can either:

**Option 1:** Replace files in folders (recommended)
- Replace `input/WBS Summary.xlsx` with your Excel file
- Replace `templates/19282-FS-Summary-FS-EXE.xer` with your template
- Output automatically goes to `output/`

**Option 2:** Edit script paths
Edit `generate_summary_schedule.py` in the `main()` function:

```python
def main():
    script_dir = Path(__file__).parent
    base_dir = script_dir.parent

    # Customize these paths
    template_xer = base_dir / "templates" / "YOUR_TEMPLATE.xer"
    summary_excel = base_dir / "input" / "YOUR_FILE.xlsx"
    output_xer = base_dir / "output" / "YOUR_OUTPUT.xer"
```

## ðŸ“Š Data Processing Rules

### Filtering
- Rows where `Total Activities` is 0, empty, or NaN are **excluded**
- Invalid dates generate warnings but rows are **included** (with empty date fields)

### Date Handling
- Parsed using pandas `to_datetime()` with error coercion
- P6 format: `YYYY-MM-DD HH:MM`
- Duration: `(Finish - Start) Ã— 8 hours/day`

### Status Assignment
- `TK_Active` (In Progress): Start date â‰¤ today
- `TK_NotStart` (Not Started): Start date > today

### Task Assignment
- All tasks assigned to **Root WBS** from template
- All tasks use **default calendar** from template
- Task type: `TT_Task` (Task Dependent)
- Duration type: `DT_FixedDUR2` (Fixed Duration)

## ðŸ§ª Testing

### Verify Installation

```bash
python -c "import pandas; import openpyxl; print('Dependencies OK')"
```

### Test Run

```bash
cd scripts
python generate_summary_schedule.py
```

Check `output/` folder for generated XER file.

### Validate Output

1. Check file size (should be ~50KB for typical project)
2. View file in text editor - should have XER format with `%T`, `%F`, `%R` markers
3. Import into P6 Professional to verify structure

## âš ï¸ Important Notes

### File Encoding
- Output XER files use **Windows-1252 (cp1252)** encoding for P6 compatibility
- Do not edit XER files in editors that change encoding

### Backup Templates
- Keep backup copies of template XER files
- Templates define project structure and settings

### Excel Format
- Use `.xlsx` format (not `.xls` or `.csv`)
- Ensure column names match exactly

### P6 Import
- Generated XER can be imported as new project or updated to existing
- Review import options in P6 before importing

## ðŸ“š Additional Resources

- **Detailed Documentation**: See `docs/README_generate_summary_schedule.md`
- **P6 XER Format**: Tab-delimited format with table markers
- **Script Source**: `scripts/generate_summary_schedule.py`

## ðŸ› Troubleshooting

| Issue | Solution |
|-------|----------|
| "Template XER not found" | Verify file exists in `templates/` folder |
| "Summary Excel not found" | Verify file exists in `input/` folder |
| "Invalid dates" warnings | Check date format in Excel, acceptable but logged |
| Import errors | Run: `pip install pandas openpyxl` |
| Empty output | Check Excel has rows with `Total Activities > 0` |
| P6 import fails | Verify template XER is valid P6 format |

## ðŸ“ž Support

For issues or questions:
1. Check `docs/README_generate_summary_schedule.md` for detailed technical information
2. Review log output for specific error messages
3. Verify input file formats and data quality

## ðŸ”„ Version History

- **v1.0** (2026-01-20) - Initial release
  - Excel to XER conversion
  - Automatic data filtering
  - Template-based generation
  - Comprehensive logging

---

**Author**: Senior Python Developer & P6 Data Engineer
**Last Updated**: 2026-01-20
